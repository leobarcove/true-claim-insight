# Trinity Cross-Check & Edge Case Scenarios

This document outlines the **Edge Cases** and **Fraud Scenarios** covered by the Trinity Cross-Check system in the Risk Engine. These scenarios are designed to detect sophisticated motor insurance fraud, including identity theft, asset cloning, and AI-fabricated evidence.

The concept is adapted from the Loan Application Checks, focusing on cross-referencing **Declared Claim Details** (FNOL) against **Extracted Document Evidence**.

## 1. Authenticity & Fabrication Checks

These checks verify the integrity of the digital files submitted.

| Scenario ID  | Edge Case                  | Description                                                                                     | Detection Logic                                                                                                          |
| :----------- | :------------------------- | :---------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------- |
| **AUTH-001** | **AI-Generated Document**  | User submits a police report or quotation generated by an LLM.                                  | Check `ai_generated` flag in extraction. Look for perfect grammar vs. known template deviations.                         |
| **AUTH-002** | **Deepfake / Stock Photo** | User submits a generic accident photo from the internet or generated by AI.                     | Check `ai_generated` in Damage Photos. Analyze `suspicious_elements` for "warped reflections" or "inconsistent shadows". |
| **AUTH-003** | **Metadata Tampering**     | Photo metadata (EXIF) shows creation date _after_ submission or `Software` = "Adobe Photoshop". | (Future) Compare file metadata against Claim Incident Date.                                                              |
| **AUTH-004** | **Screen Capture**         | User submits a photo of a screen (e.g., taking a pic of a photo on another phone).              | Check `screen_capture` flag. Moir√© patterns or bezel visibility.                                                         |

## 2. Identity Verification (Person)

Ensures the person claiming/driving is authorized and real.

| Scenario ID | Edge Case                        | Description                                                                                            | Detection Logic                                                                    |
| :---------- | :------------------------------- | :----------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------- |
| **ID-001**  | **Ghost Driver**                 | The person filing the Police Report (Complainant) does not exist or is not associated with the policy. | Compare `PoliceReport.complainant.ic_number` vs `Policy.policyholder.ic_number`.   |
| **ID-002**  | **Unauthorized Driver**          | Driver is real but not covered (e.g., under age, learner, not named).                                  | If `complainant` != `policyholder`, check if `complainant` is in `insured_person`. |
| **ID-003**  | **Identity Theft**               | NRIC extracted from MyKad image does not match the User Account or Policy.                             | Compare `MyKad.ic_number` vs `Claim.claimant.nric`.                                |
| **ID-004**  | **Underage Driver**              | Driver NRIC indicates age below legal driving limit.                                                   | Check `MyKad.age` or derived age from `ic_number`.                                 |
| **ID-005**  | **NRIC-DOB Mismatch**            | The NRIC number does not match the Date of Birth on the same document.                                 | Compare `MyKad.ic_number` (first 6 digits) vs `MyKad.date_of_birth`.               |
| **ID-006**  | **Complainant Details Mismatch** | Complainant in report does not match claimant name/NRIC.                                               | Compare `PoliceReport.complainant` vs `Claim.claimant`.                            |

## 3. Vehicle Verification (Asset)

Ensures the vehicle damaged is the one insured.

| Scenario ID | Edge Case                      | Description                                                                      | Detection Logic                                                                |
| :---------- | :----------------------------- | :------------------------------------------------------------------------------- | :----------------------------------------------------------------------------- |
| **VEH-001** | **"Klon" Car / Plate Swap**    | Vehicle in photo has the correct plate but wrong Make/Model/Color.               | Compare `DamagePhoto.vehicle` (Make/Model/Color) vs `VEHICLE_REG_CARD`.        |
| **VEH-002** | **Chassis Mismatch**           | VOC submitted belongs to a different vehicle (same make/model but different ID). | Compare `VEHICLE_REG_CARD.chassis_number` vs `Claim.chassis_number`.           |
| **VEH-003** | **Expired Road Tax**           | Vehicle was not road-legal at the time of the accident.                          | Check `VEHICLE_REG_CARD.road_tax_expiry` < `Claim.incidentDate`.               |
| **VEH-004** | **Phantom Vehicle**            | Police Report mentions a completely different vehicle involved.                  | Compare `PoliceReport.incident.description` vs `Claim.vehiclePlateNumber`.     |
| **VEH-005** | **Vehicle Owner Mismatch**     | The owner of the vehicle in the VOC is not the policyholder.                     | Compare `VEHICLE_REG_CARD.owner_ic_number` vs `Policy.policyholder.ic_number`. |
| **VEH-006** | **Quotation Vehicle Mismatch** | The vehicle details in the repair quotation do not match the insured vehicle.    | Compare `RepairQuotation.vehicle` vs `Claim.vehiclePlateNumber`.               |

## 4. Incident Logic & Consistency

Verifies that the "Story" makes sense physically and chronologically.

| Scenario ID | Edge Case                     | Description                                                                         | Detection Logic                                                                                                     |
| :---------- | :---------------------------- | :---------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------ |
| **LOG-001** | **Time Travel**               | Accident Date in Police Report is _before_ Policy Effective Date or _after_ Expiry. | Check `PoliceReport.incident.date` inside `Policy.effective_date` - `Policy.expiry_date`.                           |
| **LOG-002** | **Physics Mismatch**          | Claim says "Rear-ended" but Photos show "Frontal Damage".                           | Compare `Claim.description` + `PoliceReport.incident.description` vs `DamagePhoto.damage_assessment.damaged_areas`. |
| **LOG-003** | **Metadata Time Travel**      | Photo metadata indicates it was taken before the incident occurred.                 | Compare photo timestamp vs `Claim.incidentDate`.                                                                    |
| **LOG-004** | **GPS Location Mismatch**     | Photo GPS coordinates do not match the reported incident location.                  | Compare photo location vs `Claim.location`.                                                                         |
| **LOG-005** | **Environmental Anomaly**     | Incident at "2:00 PM" (Day) but Photos show "Night".                                | Compare `PoliceReport.incident.time` vs `DamagePhoto.environment.lighting_condition`.                               |
| **LOG-006** | **Weather Anomaly**           | Report says "Raining" but Photos show dry road/sunny sky.                           | Compare `PoliceReport.weather_condition` vs `DamagePhoto.weather_condition` / `road_surface_condition`.             |
| **LOG-007** | **Airbag Deployment Anomaly** | Severe impact reported/visible but airbags did not deploy.                          | Compare `DamagePhoto.accident_context.impact_severity` vs `airbag_deployed`.                                        |
| **LOG-008** | **Missing Signatures**        | The police report is missing mandatory signatures.                                  | Check `PoliceReport.signatures` for presence of all required signatures.                                            |

## 5. Financial Risk (Padding)

Detects exaggeration of loss.

| Scenario ID | Edge Case            | Description                                                                | Detection Logic                                                                                 |
| :---------- | :------------------- | :------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------- |
| **FIN-001** | **Repair Inflation** | Workshop quotes for parts that are not visible in the damage photos.       | Compare `RepairQuotation.repairs.parts_items` vs `DamagePhoto.damage_assessment.damaged_areas`. |
| **FIN-002** | **Unrelated Damage** | Photos show old damage (rust, different dirt layer) mixed with new damage. | Check `DamagePhoto.authenticity.suspicious_elements` or consistency logic.                      |

---

## Testing Implementation

To test these scenarios, we simulate the `dataBag` (Extracted Data) injected into the Reasoning Engine.

### Example: Simulating Protocol `LOG-002` (Physics Mismatch)

**Mock Data Injection:**

```json
{
  "claim": {
    "description": "I was rear-ended at a traffic light."
  },
  "police_report": {
    "incident": { "description": "Vehicle was hit from behind by a lorry." }
  },
  "damage_photos": [
    {
      "damage_assessment": {
        "damaged_areas": ["front_bumper", "headlamp_left", "bonnet"],
        "damage_types": ["crush", "deformation"]
      }
    }
  ]
}
```

**Expected Finding:**

> "Red Flag: Inconsistency in damage location. Claimant describes rear-end collision, but visual evidence shows severe frontal impact. Potential fraud or error in photo submission."

## Schema Refinements

To support these checks, the following fields were added to the Extraction Schemas:

- **Global**: `authenticity` dictionary (`ai_generated`, `suspicious_elements`).
- **Police Report**: `weather_condition`, `road_surface_condition`, `mentioned_vehicles`, `alleged_offenses`.
- **Policy**: `named_drivers`.
- **Damage Photo**: `environment` details, `authenticity`.
